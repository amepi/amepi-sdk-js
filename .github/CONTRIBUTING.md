# Contributing

[!NOTE] Project structure is inspired by
[Deno Standard Library](https://github.com/denoland/deno_std).

## Prerequisites

<!-- - Read this repository [wiki]() -->

- [Deno](https://deno.com/) (^1.39.3)
- [Node](https://nodejs.org/) (^20.11.0)
  - Used by some deno tasks commands (e.g. Prisma commands)
- [Visual Studio Code](https://code.visualstudio.com/)
  - [Install](https://code.visualstudio.com/docs/editor/extension-marketplace#_install-an-extension)
    and
    [Enable (Workspace)](https://code.visualstudio.com/docs/editor/extension-marketplace#_enable-an-extension)
    [workspace recommended extensions](https://code.visualstudio.com/docs/editor/extension-marketplace#_workspace-recommended-extensions):
    - See the list of recommended extensions using
      [**Show Recommended Extensions**](https://code.visualstudio.com/docs/editor/extension-marketplace#_recommended-extensions)
      - Recommended extensions can also be found in the
        [.vscode/extensions.json](../.vscode/extensions.json) file

### Optional

- [GitHub CLI](https://cli.github.com/)
- [Bitwarden Secrets Manager CLI](https://bitwarden.com/help/secrets-manager-cli/)

## Getting started

### Environment variables

Copy and paste/rename the [.env.example](../.env.example) file to
[.env](https://docs.deno.com/runtime/manual/basics/env_variables#env-file) in
the root of the project by running this command :

```Shell
deno task env:setup
```

#### Secret Manager

Bitwarden Secret Manager CLI is used for reading and injecting secrets into the
application.

### Debugging

See
["Using the debugger"](https://docs.deno.com/runtime/manual/references/vscode_deno#using-the-debugger)

## General Guide

### Managing dependencies

Remote dependencies are managed in [deps.ts](../deps.ts) and [dev_deps.ts](../dev_deps.ts) files.

See
["Managing Dependencies"](https://docs.deno.com/runtime/tutorials/manage_dependencies)

### Testing

```Shell
# run all test
deno task test
```

See ["Testing in Deno"](https://docs.deno.com/runtime/manual/basics/testing/)

#### Coverage

See ["Test Coverage"](https://docs.deno.com/runtime/manual/basics/testing/coverage)

### Prisma

This project uses the
[introspection workflow](https://www.prisma.io/docs/orm/prisma-schema/introspection#introspection-workflow).

Prisma Data Model and Prisma Client are generated by running the
[`prisma db pull`](https://www.prisma.io/docs/orm/prisma-schema/introspection#the-prisma-db-pull-command)
command and the
[`prisma generate`](https://www.prisma.io/docs/orm/reference/prisma-cli-reference#generate)
command respectively.

```Shell
# equivalent to prisma db pull command
deno task prisma:introspect
# equivalent to prisma generate command
deno task prisma:client
```

## Commits and PRs

### Vendor dependencies

[Production software should always vendor its dependencies.](https://docs.deno.com/runtime/manual/basics/modules#but-what-if-the-host-of-the-url-goes-down-the-source-wont-be-available)
Therefore run [`deno vendor`](https://docs.deno.com/runtime/manual/tools/vendor)

### Package Versioning

Increment the module version in the [version.ts](../version.ts) file.

## Deployment

### Publish to NPM

You can develop and test all your code in Deno and TypeScript. When itâ€™s time to
publish, you can use dnt to export it to Node.js/npm-compatible format.

See
[Cross-runtime modules with dnt](https://docs.deno.com/runtime/manual/advanced/publishing/dnt)

## Style Guide

### Git

- [Conventional Commits](https://www.conventionalcommits.org/en/v1.0.0/)

### JavaScript

- [Google JavaScript Style Guide](https://google.github.io/styleguide/jsguide.html)

### Package Versioning

- [Semantic Versioning](https://semver.org/)
